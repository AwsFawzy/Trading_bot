# دليل إعداد نظام المراقبة

هذا الدليل يشرح كيفية إعداد نظام مراقبة مستمر للتأكد من أن البوت يعمل بشكل دائم.

## 1. خدمة Replit Always On

خدمة Replit Always On هي الطريقة المضمونة للحفاظ على البوت قيد التشغيل دون انقطاع. هذه الخدمة متاحة مقابل $7 شهريًا وتضمن عدم نوم المشروع.

### كيفية تفعيل Always On:

1. انتقل إلى لوحة تحكم Replit
2. اختر المشروع الخاص بك
3. انقر على أيقونة الإعدادات (⚙️)
4. ابحث عن قسم "Always On" وقم بتفعيله
5. ستتم مطالبتك بالدفع ($7 شهريًا)

## 2. آلية إعادة التشغيل التلقائية

حتى مع خدمة Always On، من المفيد وجود آلية إعادة تشغيل احتياطية. أضفنا ملفين:

- `app/auto_restart.py`: يتحقق من حالة البوت ويعيد تشغيله إذا توقف
- `restart_bot_task.sh`: ملف نصي يمكن تشغيله من خلال Cron job

### كيفية إعداد مهمة Cron في Replit:

1. انتقل إلى لوحة تحكم Replit
2. اختر مشروعك ثم اضغط على زر "Shell" 
3. أنشئ Cron job لتشغيل `restart_bot_task.sh` كل 5 دقائق:

```bash
chmod +x restart_bot_task.sh
(crontab -l 2>/dev/null; echo "*/5 * * * * $(pwd)/restart_bot_task.sh") | crontab -
```

4. للتحقق من إعدادات Cron:

```bash
crontab -l
```

## 3. إعداد Uptime Robot (خدمة مجانية للمراقبة)

يمكنك أيضًا استخدام خدمة مجانية مثل Uptime Robot للتحقق من حالة البوت:

1. انشئ حساب على [Uptime Robot](https://uptimerobot.com/)
2. أضف مراقبة جديدة من نوع HTTP(s)
3. أدخل عنوان URL الخاص بالبوت: `https://اسم_المشروع.اسم_المستخدم.repl.co/api/status`
4. اضبط فترة الفحص على 5 دقائق
5. قم بتفعيل الإشعارات لتلقي تنبيهات إذا توقف البوت

## ملاحظات هامة:

- إذا استخدمت مهام Cron في Replit، تأكد من تحديث Cron job إذا قمت بتغيير اسم المشروع أو نقله.
- تأكد من وجود رصيد كاف في حسابك لخدمة Always On قبل تاريخ التجديد.
- آلية إعادة التشغيل التلقائية لن تعمل إذا كان هناك مشكلة في الكود تتسبب في فشل البوت بعد إعادة التشغيل.